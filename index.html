<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>ThreeJS</title>
	<link rel="stylesheet" href="style.css">
</head>
<body id="body">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/105/three.min.js"></script>
	<script src='https://s3-us-west-2.amazonaws.com/s.cdpn.io/2666677/OrbitControls.js'></script>

<script>
		var scene, camera, renderer, capsule, manualControl = false;

		init();

		function init(){
			const assetPath = 'https://s3-us-west-2.amazonaws.com/s.cdpn.io/2666677/';
			
			body = document.getElementById("body");
			scene = new THREE.Scene();

			const envMap = new THREE.CubeTextureLoader().load([
				'barren_ft.jpg', 'barren_bk.jpg', 'barren_up.jpg', 'barren_dn.jpg', 'barren_rt.jpg', 'barren_lf.jpg'
			]);
			scene.background = envMap;
			camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
			camera.position.set(0, 0, 8);
			
			const ambient = new THREE.HemisphereLight(0xFFFFFF, 0x080820);
			scene.add(ambient);
			
			const light = new THREE.DirectionalLight(0xFFFFFF, 3);
			light.position.set(0,2,1);
			scene.add(light);
			
			renderer = new THREE.WebGLRenderer();
			renderer.setSize(window.innerWidth, window.innerHeight);
			document.body.appendChild(renderer.domElement);

			capsule = new THREE.Group();
			const geometry = new THREE.SphereGeometry(2, 30, 20, 0, Math.PI*2, 0, Math.PI/2);
			const material = new THREE.MeshLambertMaterial({envMap: envMap});
			const sphere = new THREE.Mesh(geometry, material);
			capsule.add(sphere);
			sphere.position.y = 2.5;

			const sphere2 = sphere.clone();
			capsule.add(sphere2);
			sphere2.rotation.z = Math.PI;
			sphere2.position.y = -2.5;

			const geometry2 = new THREE.CylinderGeometry(2, 2, 5, 30, 1, true);
			const cylinder = new THREE.Mesh(geometry2, material);
			capsule.add(cylinder);
			
			window.addEventListener('resize', resize, false);
			
			update();
		}

		function update() {
			requestAnimationFrame(update);
			renderer.render(scene, camera);
			capsule.rotation.x -= 0.01;
			capsule.rotation.y += 0.01;
			capsule.rotation.z -= 0.01;
			// capsule.position.set();
			if (manualControl === false) {
				camera.rotation.y -= 0.001;
			}
		}

		function resize() {
			camera.aspect = window.innerWidth / window.innerHeight;
			camera.updateProjectionMatrix();
			renderer.setSize(window.innerWidth, window.innerHeight);
		}

		document.addEventListener("mousedown", function () {
			manualControl = true;
			const controls = new THREE.OrbitControls(camera, renderer.domElement);
			body.style.cursor = "initial";
			// scene.add(capsule);
		});

		document.addEventListener("mouseup", function () {
			manualControl = false;
			body.style.cursor = "none";
			// scene.remove(capsule);
		});
	</script>
</body>
</html>
